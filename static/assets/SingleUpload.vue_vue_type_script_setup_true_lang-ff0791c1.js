import{d as y,q as _,b as k,o,c as n,f as c,u as l,E as $}from"./index-9ffcd92b.js";const g={class:"col center"},b={key:0},U={key:1},v=["multiple","accept"],C=y({__name:"SingleUpload",props:{multiple:{type:Boolean,default:!1},accept:{type:String,default:"*/*"}},setup(r){const i=r,{state:s}=_(),a=k();function u(e){e&&e&&(a.value={name:e.name,size:e.size,contentType:e.type,lastModified:e.lastModified,url:URL.createObjectURL(e),file:e})}const d=()=>{const e=document.createElement("input");e.type="file",e.multiple=!1,e.onchange=()=>{u(e.files[0])},e.click()},m=async e=>{const t=new FormData;t.append("file",e.file);const p=await(await fetch(`/api/upload?user=${s.user.ref}&key=assets/${e.name}&size=${e.size}`,{method:"POST",body:t})).json();s.user.picture=p.url,s.notifications.push({message:"File uploaded",status:"success"});const h=encodeURIComponent(p.url);await fetch(`/api/user/${s.user.ref}?picture=${h}`,{method:"PUT"})};return(e,t)=>(o(),n("div",g,[c("label",{for:"singleFile",name:"file",class:"dropzone",onClick:d},[l(a)?(o(),n("div",b,[$(e.$slots,"default",{data:l(a)})])):(o(),n("div",U,"Click to upload")),c("input",{type:"file",multiple:i.multiple,id:"singleFile",class:"hidden",accept:i.accept},null,8,v)]),c("button",{class:"btn-get",onClick:t[0]||(t[0]=f=>{m(l(a)),e.$emit("close")})}," Upload ")]))}});export{C as _};
